
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>واجهة المنتجات</title>

  <!-- CSS مدمج لملف واحد كما طلبت -->
  <style>
    :root{
      --bg:#f5f7fb;
      --card:#fff;
      --accent:#2b6cb0;
      --muted:#777;
      --radius:12px;
      --gap:18px;
    }
    *{box-sizing:border-box;font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif}
    body{
      margin:0;background:var(--bg);color:#111;padding:30px;
      direction:rtl;
    }

    .container{
      max-width:1100px;margin:0 auto;
    }

    header{
      display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;
    }
    header h1{margin:0;font-size:22px}
    header .controls{display:flex;gap:12px;align-items:center}
    .btn{
      background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;
      box-shadow:0 6px 18px rgba(43,108,176,.12);
    }
    .btn.secondary{background:#fff;color:var(--accent);border:1px solid rgba(43,108,176,.12);}
    .search{
      padding:8px 12px;border-radius:10px;border:1px solid #e0e6ef;background:#fff;
      width:320px;
    }

    /* grid المنتجات */
    .grid{
      display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:var(--gap);
      margin-top:10px;
    }
    .card{
      background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 6px 18px rgba(6,18,45,.04);
      display:flex;flex-direction:column;gap:10px;
    }
    .card .img{
      height:160px;border-radius:10px;background:#f0f4fb;background-size:cover;background-position:center;
    }
    .card h3{margin:0;font-size:16px}
    .card .price{font-weight:700;color:var(--accent)}
    .row{display:flex;justify-content:space-between;align-items:center;gap:12px}
    .muted{color:var(--muted);font-size:13px}

    /* تفاصيل المنتج */
    .detail{
      display:flex;gap:18px;align-items:flex-start;
    }
    .detail .left{flex:1}
    .detail .right{flex:1;min-width:280px}
    .detail img{max-width:100%;border-radius:10px;display:block}

    /* نموذج الإضافة */
    form.add-form{display:flex;flex-direction:column;gap:10px;background:var(--card);padding:14px;border-radius:12px}
    form.add-form input, form.add-form textarea, form.add-form select{
      padding:10px;border-radius:8px;border:1px solid #e6edf6;background:#fff;width:100%;
    }

    footer{margin-top:30px;color:var(--muted);font-size:14px;text-align:center}
    @media (max-width:600px){
      header{flex-direction:column;align-items:flex-start;gap:10px}
      .search{width:100%}
      .detail{flex-direction:column}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>متجر واجهة المنتجات</h1>
      <div class="controls">
        <form method="get" action="/" style="display:inline;">
          <input name="q" class="search" placeholder="ابحث عن منتج..." value="{{ request.args.get('q','') }}" />
        </form>
        <a href="/add" class="btn">أضف منتج</a>
      </div>
    </header>

    {# إذا كانت صفحة التفاصيل، يتم عرض تفصيل واحد #}
    {% if product %}
      <section class="card">
        <div class="detail">
          <div class="left">
            <img src="{{ product.image }}" alt="{{ product.name }}" />
            <h2 style="margin-top:12px">{{ product.name }}</h2>
            <p class="muted">السعر: <span class="price">{{ product.price }} د.و</span></p>
            <p class="muted">الرمز التعريفي: {{ product.id }}</p>
          </div>
          <div class="right">
            <h3>الوصف</h3>
            <p>{{ product.description or 'لا يوجد وصف' }}</p>
            <div style="margin-top:12px">
              <a href="/" class="btn secondary">العودة للمنتجات</a>
            </div>
          </div>
        </div>
      </section>
    {% elif show_add %}
      {# صفحة إضافة منتج #}
      <section class="card">
        <h2>أضف منتج جديد</h2>
        <form class="add-form" method="post" action="/add">
          <label>اسم المنتج</label>
          <input name="name" required />
          <label>السعر (رقم)</label>
          <input name="price" type="number" step="0.01" required />
          <label>رابط صورة المنتج (URL)</label>
          <input name="image" placeholder="https://..." />
          <label>وصف المنتج</label>
          <textarea name="description" rows="4"></textarea>
          <div style="display:flex;gap:10px;justify-content:flex-end">
            <a href="/" class="btn secondary">إلغاء</a>
            <button class="btn" type="submit">إضافة المنتج</button>
          </div>
        </form>
      </section>
    {% else %}
      {# صفحة عرض الشبكة #}
      <section class="grid">
        {% for p in products %}
          <article class="card">
            <div class="img" style="background-image:url('{{ p.image or 'https://via.placeholder.com/400x300?text=No+Image' }}')"></div>
            <h3>{{ p.name }}</h3>
            <div class="row">
              <div class="muted">رمز: {{ p.id }}</div>
              <div class="price">{{ p.price }} د.و</div>
            </div>
            <p class="muted" style="min-height:40px">{{ (p.description[:90] ~ ('...' if p.description|length>90 else '')) if p.description else '' }}</p>
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:auto">
              <a href="/product/{{ p.id }}" class="btn secondary">تفاصيل</a>
            </div>
          </article>
        {% else %}
          <div class="card">لا توجد منتجات بعد. <a href="/add" class="btn" style="margin-left:10px">أضف أول منتج</a></div>
        {% endfor %}
      </section>
    {% endif %}

    <footer>
      نسخة بسيطة لواجهة عرض/إضافة/تفاصيل المنتجات — مصممة للعمل مع Flask وJinja.
    </footer>
  </div>
</body>
</html>
